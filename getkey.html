<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¿å‘ŠéªŒè¯ | BENG-SCRIPT</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide å›¾æ ‡ -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="min-h-screen bg-black flex items-center justify-center p-4" 
      style="background: radial-gradient(circle at 50% 0%, #111 0%, #000 100%)">
    
    <div class="bg-white/[0.04] backdrop-blur-[35px] border border-white/10 rounded-[30px] p-10 w-full max-w-[380px] shadow-2xl">
        <h2 class="text-white text-[22px] font-normal text-center mb-8 tracking-tight">
            ğŸ”„ é˜¶æ®µéªŒè¯
        </h2>
        
        <!-- é˜¶æ®µè¿›åº¦æ¡ -->
        <div class="flex justify-between mb-8 relative">
            <div class="absolute top-1/2 left-[10%] right-[10%] h-0.5 bg-white/10 -translate-y-1/2 z-0"></div>
            <div class="relative z-10 flex flex-col items-center">
                <div id="stage-0" class="stage-dot">
                    0
                </div>
                <span class="absolute -bottom-6 text-[10px] text-gray-500 whitespace-nowrap">
                    é˜¶æ®µ 0
                </span>
            </div>
            <div class="relative z-10 flex flex-col items-center">
                <div id="stage-1" class="stage-dot">
                    1
                </div>
                <span class="absolute -bottom-6 text-[10px] text-gray-500 whitespace-nowrap">
                    é˜¶æ®µ 1
                </span>
            </div>
            <div class="relative z-10 flex flex-col items-center">
                <div id="stage-2" class="stage-dot">
                    2
                </div>
                <span class="absolute -bottom-6 text-[10px] text-gray-500 whitespace-nowrap">
                    é˜¶æ®µ 2
                </span>
            </div>
            <div class="relative z-10 flex flex-col items-center">
                <div id="stage-3" class="stage-dot">
                    3
                </div>
                <span class="absolute -bottom-6 text-[10px] text-gray-500 whitespace-nowrap">
                    é˜¶æ®µ 3
                </span>
            </div>
        </div>
        
        <!-- å†…å®¹åŒºåŸŸ -->
        <div id="content-area">
            <div id="loading" class="flex items-center justify-center gap-3 text-gray-400">
                <svg class="animate-spin h-5 w-5" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                </svg>
                <span>æ­£åœ¨åŠ è½½éªŒè¯ä¿¡æ¯...</span>
            </div>
            
            <div id="main-content" style="display: none;">
                <p class="text-center text-gray-300 mb-5 mt-10">
                    å½“å‰ï¼š<span class="font-bold text-white" id="current-stage">é˜¶æ®µ 0</span> â†’ 
                    è¿›å…¥ <span class="font-bold text-white" id="next-stage">é˜¶æ®µ 1</span>
                    <br>
                    <span class="text-sm text-gray-500">è¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å®Œæˆä»»åŠ¡ä»¥ç»§ç»­ã€‚</span>
                </p>
                
                <div class="p-4 bg-red-500/10 border border-red-500/20 rounded-xl mb-5">
                    <p class="text-[13px] text-red-400 flex items-start gap-2">
                        <svg class="w-4 h-4 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.67 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                        </svg>
                        <span>
                            æ³¨æ„ï¼šéƒ¨åˆ†å¹¿å‘Šå•†ï¼ˆå¦‚LootLabsï¼‰ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°/callback<br>
                            è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†
                        </span>
                    </p>
                </div>
                
                <a id="ad-button" href="#" target="_blank" 
                   class="block w-full py-4 bg-white/[0.08] backdrop-blur-[15px] border border-white/10 rounded-[18px] text-white font-semibold text-center hover:bg-white/15 hover:-translate-y-0.5 transition-all duration-300">
                    <svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                    </svg>
                    å¼€å§‹ é˜¶æ®µ 1 éªŒè¯
                </a>
                
                <p class="text-xs text-gray-500 mt-5 text-center flex items-center justify-center gap-1">
                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    å®Œæˆå¹¿å‘Šåä¼šè‡ªåŠ¨è¿”å›å¹¶è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
                </p>
                
                <div class="mt-5 p-4 bg-white/[0.03] rounded-xl">
                    <p class="text-xs text-gray-400 text-center flex items-center justify-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                        <span>
                            é˜¶æ®µéªŒè¯ä¿æŠ¤å·²å¯ç”¨<br>
                            ç¡®ä¿æŒ‰é¡ºåºå®Œæˆæ‰€æœ‰é˜¶æ®µ
                        </span>
                    </p>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-5 text-xs text-gray-600">
            <a href="key.html" class="text-gray-400 hover:text-white hover:underline mx-2 transition-colors">
                è¿”å›å¯†é’¥é¡µé¢
            </a>
            |
            <a href="/" class="text-gray-400 hover:text-white hover:underline mx-2 transition-colors">
                è¿”å›é¦–é¡µ
            </a>
        </div>
    </div>

    <script>
        // é…ç½®
        const API_BASE_URL = 'https://key-system.2176671594.workers.dev';
        const stageNames = ["é˜¶æ®µ 0", "é˜¶æ®µ 1", "é˜¶æ®µ 2", "é˜¶æ®µ 3"];
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initPage();
        });
        
        async function initPage() {
            // ä»URLè·å–token
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            
            if (!token) {
                // æ²¡æœ‰tokenï¼Œæ˜¾ç¤ºé”™è¯¯
                document.getElementById('loading').innerHTML = `
                    <div class="text-center text-red-400">
                        <svg class="w-8 h-8 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <p>æ— æ•ˆçš„éªŒè¯é“¾æ¥ï¼Œç¼ºå°‘tokenå‚æ•°</p>
                        <a href="key.html" 
                           class="mt-4 block w-full py-4 bg-red-500/10 border border-red-500/20 rounded-[18px] text-white font-semibold text-center hover:bg-red-500/20 transition-all">
                            è¿”å›é‡æ–°è·å–é“¾æ¥
                        </a>
                    </div>
                `;
                return;
            }
            
            // è®¾ç½®å¹¿å‘Šé“¾æ¥
            const adLink = `${API_BASE_URL}/start?token=${token}`;
            document.getElementById('ad-button').href = adLink;
            
            // è®°å½•å¹¿å‘Šç‚¹å‡»
            document.getElementById('ad-button').addEventListener('click', function() {
                recordAdClick(token);
            });
            
            // æ›´æ–°é˜¶æ®µæ˜¾ç¤º
            updateStageProgress(0, 1);
            
            // éšè—åŠ è½½ï¼Œæ˜¾ç¤ºå†…å®¹
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('main-content').style.display = 'block';
            }, 1000);
        }
        
        function updateStageProgress(currentStage, nextStage) {
            // æ›´æ–°é˜¶æ®µç‚¹
            for (let i = 0; i <= 3; i++) {
                const stageDot = document.getElementById(`stage-${i}`);
                if (i < currentStage) {
                    stageDot.className = 'stage-dot completed';
                    stageDot.innerHTML = `
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                    `;
                } else if (i === currentStage) {
                    stageDot.className = 'stage-dot active';
                } else {
                    stageDot.className = 'stage-dot';
                }
            }
            
            // æ›´æ–°æ–‡æœ¬
            document.getElementById('current-stage').textContent = stageNames[currentStage];
            document.getElementById('next-stage').textContent = stageNames[nextStage];
            document.getElementById('ad-button').innerHTML = `
                <svg class="w-4 h-4 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                </svg>
                å¼€å§‹ ${stageNames[nextStage]} éªŒè¯
            `;
        }
        
        function recordAdClick(token) {
            if (token) {
                fetch(`${API_BASE_URL}/ad-start?token=${token}`, { method: 'POST' })
                    .catch(err => console.error('è®°å½•å¹¿å‘Šç‚¹å‡»å¤±è´¥:', err));
                document.cookie = `ll_token=${token}; path=/; max-age=3600`;
            }
        }
        
        // æ·»åŠ æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            .stage-dot {
                width: 32px;
                height: 32px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
                font-weight: 500;
                border: 1px solid rgba(255,255,255,0.1);
                background: rgba(255,255,255,0.05);
                color: #9ca3af;
                transition: all 0.3s;
            }
            .stage-dot.active {
                background: rgba(255,255,255,0.15);
                border-color: rgba(255,255,255,0.3);
                color: white;
            }
            .stage-dot.completed {
                background: rgba(34,197,94,0.1);
                border-color: rgba(34,197,94,0.3);
                color: #4ade80;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
